{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { editStage, viewStages, saveStageDetails, viewStagesBystage, deleteStageDetails, saveStage, getFailureCondition, saveFailureCondition, deleteStage } from '@/api/index';\nimport Aside from '@/components/Aside.vue';\nexport default {\n  name: 'KfuEstimate',\n  components: {\n    Aside\n  },\n\n  data() {\n    return {\n      isActive: 0,\n      stages: [{\n        name: '',\n        total_times: ''\n      }],\n      selectdata: [],\n      disease_position: '',\n      disease_sort: '',\n      name: '',\n      sort: '',\n      activeName: 'second',\n      tableData: [{\n        name: '膝关节伸展角度',\n        type: '数值',\n        target: 0,\n        condition: '大于',\n        attribute: '客观评价'\n      }],\n      // 对话弹框1\n      dialogFormVisible: false,\n      formLabelWidth: '130px',\n      dialog: {\n        name: '',\n        type: '',\n        target: 0,\n        condition: '',\n        attribute: ''\n      },\n      // 对话弹框2\n      dialogFormVisible2: false,\n      dialog2: {\n        add_assess: '',\n        add_train: ''\n      },\n      // 对话弹框3\n      dialogFormVisible3: false,\n      dialog3: {\n        stageName: '',\n        totalTimes: ''\n      },\n      editProp: ['name', 'type', 'target', 'condition', 'attribute'],\n      form: {\n        name: '',\n        total_times: 0,\n        id: ''\n      }\n    };\n  },\n\n  created() {\n    this.disease_position = this.$route.query.disease_position;\n    this.disease_sort = this.$route.query.disease_sort;\n    this.name = this.$route.query.name;\n    this.getLeft(); //获取左边的阶段数据\n  },\n\n  methods: {\n    // 点击切换阶段\n    changeStages(index) {\n      this.isActive = index;\n      this.form.name = this.stages[index].name;\n      this.form.total_times = this.stages[index].total_times;\n      this.getData();\n    },\n\n    getLeft() {\n      let obj = {\n        prescription_details_id: this.$route.query.id\n      };\n      viewStages(obj).then(res => {\n        this.stages = res.data;\n        this.changeStages(0);\n      });\n    },\n\n    // 获取阶段名称,id\n    getData() {\n      let obj1 = {\n        stage_id: this.stages[this.isActive].id\n      }; // 获取右边的表格数据\n\n      viewStagesBystage(obj1).then(res => {\n        this.tableData = res.data;\n      });\n    },\n\n    // 编辑/更新阶段的详情\n    saveTable() {\n      let obj = {\n        id: this.$route.query.id,\n        stage_id: '1',\n        name: '',\n        type: '',\n        target: '',\n        condition: '',\n        attribute: ''\n      };\n      editStage(obj).then(res => {\n        console.log(res);\n      });\n    },\n\n    /** 鼠标移入cell */\n    // 鼠标双击时进入编辑模式\n    handleCellDblclick(row, column, cell, event) {\n      const property = column.property;\n\n      if (this.editProp.includes(property)) {\n        cell.querySelector('.item__input').style.display = 'block';\n        cell.querySelector('.item__txt').style.display = 'none';\n      }\n    },\n\n    /** 鼠标移出cell */\n    handleCellLeave(row, column, cell, event) {\n      const property = column.property;\n\n      if (this.editProp.includes(property)) {\n        cell.querySelector('.item__input').style.display = 'none';\n        cell.querySelector('.item__txt').style.display = 'block';\n      } // TODO:发请求进行编辑阶段详情的保存\n\n    },\n\n    // 新增阶段详情\n    addStageDetail() {\n      this.dialogFormVisible = true;\n    },\n\n    // 弹框1保存按钮\n    saveBtn() {\n      this.dialogFormVisible = false;\n      let obj = {\n        stage_id: this.stages[this.isActive].id,\n        name: this.dialog.name,\n        type: this.dialog.type,\n        target: this.dialog.target,\n        condition: this.dialog.condition,\n        attribute: this.dialog.attribute,\n        assess_times: this.dialog.assess_times,\n        train_times: this.dialog.train_times\n      };\n      saveStageDetails(obj).then(res => {\n        console.log(res); // this.tableData.push(res.data)\n\n        if (res.code == 200) {\n          this.getData();\n          this.$message({\n            message: '新增成功',\n            type: 'success'\n          });\n          this.getData();\n        }\n      });\n    },\n\n    // 进阶失败保存追加 弹框2保存按钮\n    saveBtn2() {\n      this.dialogFormVisible2 = false;\n      let obj = {\n        stage_id: this.stages[this.isActive].id,\n        add_assess: this.dialog2.add_assess,\n        add_train: this.dialog2.add_train\n      };\n      saveFailureCondition(obj).then(res => {\n        if (res.code == 200) {\n          this.$message({\n            message: '保存成功',\n            type: 'success'\n          });\n        }\n      });\n    },\n\n    // 新增阶段\n    addStages() {\n      this.dialogFormVisible3 = true;\n    },\n\n    // 新增阶段 弹框3保存按钮\n    saveBtn3() {\n      this.dialogFormVisible3 = false;\n      let obj = {\n        prescription_details_id: this.$route.query.id,\n        stageName: this.dialog3.stageName,\n        totalTimes: this.dialog3.totalTimes\n      };\n      saveStage(obj).then(res => {\n        console.log(res);\n\n        if (res.code == 200) {\n          this.getLeft();\n          this.$message({\n            type: 'success',\n            message: '新增成功'\n          });\n        }\n      });\n    },\n\n    selectchange(val) {\n      this.selectdata = val;\n    },\n\n    // 批量删除\n    deleteLot() {\n      if (this.selectdata.length) {\n        var list = [];\n        this.selectdata.forEach(ele => {\n          list.push(ele.id);\n        });\n        deleteStageDetails({\n          ids: list.join(',')\n        }).then(res => {\n          if (res.code == 200) {\n            this.getData();\n            this.$message({\n              message: '删除成功',\n              type: 'success'\n            });\n          }\n        });\n      }\n    },\n\n    // 修改阶段名称和阶段时长\n    editStage() {},\n\n    // 进阶失败查询/追加\n    failed() {\n      this.dialogFormVisible2 = true;\n      let obj = {\n        stage_id: this.stages[this.isActive].id\n      };\n      getFailureCondition(obj).then(res => {\n        console.log(res.data[0]);\n        this.dialog2 = res.data[0];\n      });\n    },\n\n    // 删除阶段\n    deleteStages(item) {\n      let obj = {\n        stage_id: item.id\n      };\n      deleteStage(obj).then(res => {\n        if (res.code == 200) {\n          this.getLeft();\n          this.$message({\n            type: 'success',\n            message: '删除成功'\n          });\n        }\n      });\n    },\n\n    next() {\n      this.$router.push({\n        path: '/avoidsymptom',\n        query: {\n          id: this.$route.query.id,\n          name: this.$route.query.name,\n          disease_position: this.$route.query.disease_position,\n          disease_sort: this.$route.query.disease_sort\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":";AA4KA;AACA;AACA;EACAA,mBADA;EAEAC;IAAAC;EAAA,CAFA;;EAGAC;IACA;MACAC,WADA;MAEAC,SACA;QACAL,QADA;QAEAM;MAFA,CADA,CAFA;MAQAC,cARA;MASAC,oBATA;MAUAC,gBAVA;MAWAT,QAXA;MAYAU,QAZA;MAaAC,oBAbA;MAcAC,YACA;QACAZ,eADA;QAEAa,UAFA;QAGAC,SAHA;QAIAC,eAJA;QAKAC;MALA,CADA,CAdA;MAuBA;MACAC,wBAxBA;MAyBAC,uBAzBA;MA0BAC;QACAnB,QADA;QAEAa,QAFA;QAGAC,SAHA;QAIAC,aAJA;QAKAC;MALA,CA1BA;MAiCA;MACAI,yBAlCA;MAmCAC;QACAC,cADA;QAEAC;MAFA,CAnCA;MAuCA;MACAC,yBAxCA;MAyCAC;QACAC,aADA;QAEAC;MAFA,CAzCA;MA8CAC,8DA9CA;MA+CAC;QACA7B,QADA;QAEAM,cAFA;QAGAwB;MAHA;IA/CA;EAqDA,CAzDA;;EA0DAC;IACA;IACA;IACA;IACA,eAJA,CAKA;EACA,CAhEA;;EAiEAC;IACA;IACAC;MACA;MACA;MACA;MACA;IACA,CAPA;;IAQAC;MACA;QACAC;MADA;MAGAC;QACA;QACA;MACA,CAHA;IAIA,CAhBA;;IAiBA;IACAC;MACA;QACAC;MADA,EADA,CAIA;;MACAC;QACA;MACA,CAFA;IAGA,CA1BA;;IA2BA;IACAC;MACA;QACAV,wBADA;QAEAQ,aAFA;QAGAtC,QAHA;QAIAa,QAJA;QAKAC,UALA;QAMAC,aANA;QAOAC;MAPA;MASAyB;QACAC;MACA,CAFA;IAGA,CAzCA;;IA0CA;IACA;IACAC;MACA;;MACA;QACAC;QACAA;MACA;IACA,CAlDA;;IAmDA;IACAC;MACA;;MACA;QACAD;QACAA;MACA,CALA,CAMA;;IACA,CA3DA;;IA4DA;IACAE;MACA;IACA,CA/DA;;IAgEA;IACAC;MACA;MACA;QACAT,uCADA;QAEAtC,sBAFA;QAGAa,sBAHA;QAIAC,0BAJA;QAKAC,gCALA;QAMAC,gCANA;QAOAgC,sCAPA;QAQAC;MARA;MAUAC;QACAR,iBADA,CAEA;;QACA;UACA;UACA;YACAS,eADA;YAEAtC;UAFA;UAIA;QACA;MACA,CAXA;IAYA,CAzFA;;IA2FA;IACAuC;MACA;MACA;QACAd,uCADA;QAEAhB,mCAFA;QAGAC;MAHA;MAKA8B;QACA;UACA;YACAF,eADA;YAEAtC;UAFA;QAIA;MACA,CAPA;IAQA,CA3GA;;IA6GA;IACAyC;MACA;IACA,CAhHA;;IAiHA;IACAC;MACA;MACA;QACApB,6CADA;QAEAT,iCAFA;QAGAC;MAHA;MAKA6B;QACAd;;QACA;UACA;UACA;YACA7B,eADA;YAEAsC;UAFA;QAIA;MACA,CATA;IAUA,CAnIA;;IAqIAM;MACA;IACA,CAvIA;;IAwIA;IACAC;MACA;QACA;QACA;UACAC;QACA,CAFA;QAGAC;UAAAC;QAAA;UACA;YACA;YACA;cACAV,eADA;cAEAtC;YAFA;UAIA;QACA,CARA;MASA;IACA,CAzJA;;IA0JA;IACA4B,cA3JA;;IA6JA;IACAqB;MACA;MACA;QACAxB;MADA;MAGAyB;QACArB;QACA;MACA,CAHA;IAIA,CAvKA;;IAwKA;IACAsB;MACA;QACA1B;MADA;MAGA2B;QACA;UACA;UACA;YACApD,eADA;YAEAsC;UAFA;QAIA;MACA,CARA;IASA,CAtLA;;IAuLAe;MACA;QACAC,qBADA;QAEAC;UACAtC,wBADA;UAEA9B,4BAFA;UAGAQ,oDAHA;UAIAC;QAJA;MAFA;IASA;;EAjMA;AAjEA","names":["name","components","Aside","data","isActive","stages","total_times","selectdata","disease_position","disease_sort","sort","activeName","tableData","type","target","condition","attribute","dialogFormVisible","formLabelWidth","dialog","dialogFormVisible2","dialog2","add_assess","add_train","dialogFormVisible3","dialog3","stageName","totalTimes","editProp","form","id","created","methods","changeStages","getLeft","prescription_details_id","viewStages","getData","stage_id","viewStagesBystage","saveTable","editStage","console","handleCellDblclick","cell","handleCellLeave","addStageDetail","saveBtn","assess_times","train_times","saveStageDetails","message","saveBtn2","saveFailureCondition","addStages","saveBtn3","saveStage","selectchange","deleteLot","list","deleteStageDetails","ids","failed","getFailureCondition","deleteStages","deleteStage","next","path","query"],"sourceRoot":"src/views/expert","sources":["KfuStage.vue"],"sourcesContent":["<template>\r\n  <div class=\"content-box\">\r\n    <div class=\"head\">\r\n      <ul class=\"step\">\r\n        <li style=\"color:#BCA791;font-size:16px\">{{disease_sort}}-{{disease_position}}-{{name}}</li>\r\n        <li><span style=\"background:#F49B4D;\">1</span>康复阶段</li>\r\n        <li><span>2</span>禁忌症</li>\r\n        <li><span>3</span>康复评估</li>\r\n        <li><span>4</span>康复方案</li>\r\n      </ul>\r\n    </div>\r\n\r\n    <el-row type=\"flex\" style=\"height:100%\">\r\n      <el-col :span=\"4\">\r\n        <el-card class=\"left\" shadow=\"always\" style=\"margin:0 10px\">\r\n          <ul>\r\n            <li :class=\"{active : isActive===index }\" style=\"white-space: nowrap;text-overflow:ellipsis; overflow:hidden;\" v-for=\"(item,index) in stages\" @click=\"changeStages(index)\">\r\n              {{item.name }}\r\n              <el-button icon=\"el-icon-edit\" size=\"mini\" type=\"text\"></el-button>\r\n              <el-button icon=\"el-icon-delete\" size=\"mini\" type=\"text\" @click=\"deleteStages(item)\"></el-button>\r\n            </li>\r\n            <li style=\"background:#FFEAE3\" @click=\"addStages\"><span>+</span></li>\r\n          </ul>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <el-col :span=\"20\">\r\n        <el-card class=\"right\" shadow=\"always\" style=\"margin-right:10px;\">\r\n          <div class=\"right-head\">\r\n            <el-form :inline=\"true\" :model=\"form\">\r\n              <el-form-item>\r\n                <el-button @click=\"addStageDetail\" style=\"background:#F49B4D;\">新增功能</el-button>\r\n                <el-button style=\"background: rgba(0,0,0,0.2);color: #FFFFFF;\">新增力量测试</el-button>\r\n                <el-button @click=\"deleteLot\" style=\"color:#F49B4D;border:1px solid #F49B4D\">批量删除</el-button>\r\n                <el-button @click=\"failed\" style=\"color:#F49B4D;border:1px solid #F49B4D\">进阶失败</el-button>\r\n              </el-form-item>\r\n              <el-form-item label=\"阶段名称：\">\r\n                <el-input placeholder=\"请输入内容\" v-model=\"form.name\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"该阶段时长(天)：\">\r\n                <el-input placeholder=\"\" v-model=\"form.total_times\"></el-input>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n\r\n          <el-table @selection-change=\"selectchange\" ref=\"multipleTable\" :data=\"tableData\" :header-cell-style=\"{background:'#EBE0D8',color:'#000000'}\" @cell-dblclick=\"handleCellDblclick\" @cell-mouse-leave=\"handleCellLeave\">\r\n            <el-table-column type=\"selection\" width=\"55\">\r\n            </el-table-column>\r\n            <el-table-column label=\"序号\" width=\"60\" type=\"index\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"name\" label=\"功能名称\" width=\"170\">\r\n              <div class=\"item\" slot-scope=\"scope\">\r\n                <el-input class=\"item__input\" v-model=\"scope.row.name\" placeholder=\"请输入内容\"></el-input>\r\n                <div class=\"item__txt\">{{scope.row.name}}</div>\r\n              </div>\r\n            </el-table-column>\r\n            <el-table-column prop=\"type\" label=\"类型\" show-overflow-tooltip>\r\n              <div class=\"item\" slot-scope=\"scope\">\r\n                <el-input class=\"item__input\" v-model=\"scope.row.type\" placeholder=\"请输入内容\"></el-input>\r\n                <div class=\"item__txt\">{{scope.row.type}}</div>\r\n              </div>\r\n            </el-table-column>\r\n            <el-table-column prop=\"target\" label=\"进阶下一段目标值\" show-overflow-tooltip>\r\n              <div class=\"item\" slot-scope=\"scope\">\r\n                <el-input class=\"item__input\" v-model=\"scope.row.target\" placeholder=\"请输入内容\"></el-input>\r\n                <div class=\"item__txt\">{{scope.row.target}}</div>\r\n              </div>\r\n            </el-table-column>\r\n            <el-table-column prop=\"condition\" label=\"条件\" show-overflow-tooltip>\r\n              <div class=\"item\" slot-scope=\"scope\">\r\n                <el-input class=\"item__input\" v-model=\"scope.row.condition\" placeholder=\"请输入内容\"></el-input>\r\n                <div class=\"item__txt\">{{scope.row.condition}}</div>\r\n              </div>\r\n            </el-table-column>\r\n            <el-table-column prop=\"attribute\" label=\"属性\" show-overflow-tooltip>\r\n              <div class=\"item\" slot-scope=\"scope\">\r\n                <el-input class=\"item__input\" v-model=\"scope.row.attribute\" placeholder=\"请输入内容\"></el-input>\r\n                <div class=\"item__txt\">{{scope.row.attribute}}</div>\r\n              </div>\r\n            </el-table-column>\r\n          </el-table>\r\n\r\n          <div class=\"btn\">\r\n            <el-button @click=\"saveTable\" style=\"margin-right:150px\">保存</el-button>\r\n            <el-button class=\"nextStep\" @click=\"next\">下一步</el-button>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <!-- 新增功能弹框1 -->\r\n    <template>\r\n      <el-dialog title=\"新增功能\" :visible.sync=\"dialogFormVisible\" width=\"30%\" center>\r\n        <el-form :model=\"dialog\">\r\n          <el-form-item label=\"功能名称：\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"dialog.name\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"类型\" :label-width=\"formLabelWidth\">\r\n            <el-select v-model=\"dialog.type\" placeholder=\"数值\">\r\n              <el-option label=\"数值\" value=\"数值\"></el-option>\r\n              <el-option label=\"量表\" value=\"量表\"></el-option>\r\n              <el-option label=\"是/否\" value=\"是/否\"></el-option>\r\n              <el-option label=\"等长-最大力量\" value=\"等长-最大力量\"></el-option>\r\n              <el-option label=\"等速-峰值力矩\" value=\"等速-峰值力矩\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"进阶下一段目标值\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"dialog.target\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"条件\" :label-width=\"formLabelWidth\">\r\n            <el-select v-model=\"dialog.condition\" placeholder=\"小于\">\r\n              <el-option label=\"大于\" value=\"大于\"></el-option>\r\n              <el-option label=\"小于\" value=\"小于\"></el-option>\r\n              <el-option label=\"等于\" value=\"等于\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"属性\" :label-width=\"formLabelWidth\">\r\n            <el-select v-model=\"dialog.attribute\" placeholder=\"主观评估\">\r\n              <el-option label=\"主观评估\" value=\"主观评估\"></el-option>\r\n              <el-option label=\"客观评估\" value=\"客观评估\"></el-option>\r\n              <el-option label=\"力量评估\" value=\"力量评估\"></el-option>\r\n              <el-option label=\"其他\" value=\"其他\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"saveBtn\">保 存</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </template>\r\n\r\n    <!-- 进阶失败弹框2 -->\r\n    <template>\r\n      <el-dialog title=\"未达到进阶标准\" :visible.sync=\"dialogFormVisible2\" width=\"30%\" center>\r\n        <el-form :model=\"dialog2\">\r\n          <el-form-item label=\"增加评估次数(次)\" label-width=\"150px\">\r\n            <el-input v-model=\"dialog2.add_assess\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"增加训练次数(次)\" label-width=\"150px\">\r\n            <el-input v-model=\"dialog2.add_train\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"dialogFormVisible2=false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"saveBtn2\">保 存</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </template>\r\n\r\n    <!-- 新增阶段的弹框3 -->\r\n    <template>\r\n      <el-dialog title=\"新增康复阶段\" :visible.sync=\"dialogFormVisible3\" width=\"30%\">\r\n        <el-form :model=\"dialog3\">\r\n          <el-form-item label=\"阶段名称\" label-width=\"150px\">\r\n            <el-input v-model=\"dialog3.stageName\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"时长(天)\" label-width=\"150px\">\r\n            <el-input v-model=\"dialog3.totalTimes\" autocomplete=\"off\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"dialogFormVisible3=false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"saveBtn3\">保 存</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </template>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport { editStage, viewStages, saveStageDetails, viewStagesBystage, deleteStageDetails, saveStage, getFailureCondition, saveFailureCondition, deleteStage } from '@/api/index'\r\nimport Aside from '@/components/Aside.vue'\r\nexport default {\r\n  name: 'KfuEstimate',\r\n  components: { Aside },\r\n  data() {\r\n    return {\r\n      isActive: 0,\r\n      stages: [\r\n        {\r\n          name: '',\r\n          total_times: ''\r\n        }\r\n      ],\r\n      selectdata: [],\r\n      disease_position: '',\r\n      disease_sort: '',\r\n      name: '',\r\n      sort: '',\r\n      activeName: 'second',\r\n      tableData: [\r\n        {\r\n          name: '膝关节伸展角度',\r\n          type: '数值',\r\n          target: 0,\r\n          condition: '大于',\r\n          attribute: '客观评价'\r\n        }\r\n      ],\r\n      // 对话弹框1\r\n      dialogFormVisible: false,\r\n      formLabelWidth: '130px',\r\n      dialog: {\r\n        name: '',\r\n        type: '',\r\n        target: 0,\r\n        condition: '',\r\n        attribute: ''\r\n      },\r\n      // 对话弹框2\r\n      dialogFormVisible2: false,\r\n      dialog2: {\r\n        add_assess: '',\r\n        add_train: ''\r\n      },\r\n      // 对话弹框3\r\n      dialogFormVisible3: false,\r\n      dialog3: {\r\n        stageName: '',\r\n        totalTimes: ''\r\n      },\r\n\r\n      editProp: ['name', 'type', 'target', 'condition', 'attribute'],\r\n      form: {\r\n        name: '',\r\n        total_times: 0,\r\n        id: ''\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.disease_position = this.$route.query.disease_position\r\n    this.disease_sort = this.$route.query.disease_sort\r\n    this.name = this.$route.query.name\r\n    this.getLeft()\r\n    //获取左边的阶段数据\r\n  },\r\n  methods: {\r\n    // 点击切换阶段\r\n    changeStages(index) {\r\n      this.isActive = index\r\n      this.form.name = this.stages[index].name\r\n      this.form.total_times = this.stages[index].total_times\r\n      this.getData()\r\n    },\r\n    getLeft() {\r\n      let obj = {\r\n        prescription_details_id: this.$route.query.id\r\n      }\r\n      viewStages(obj).then(res => {\r\n        this.stages = res.data\r\n        this.changeStages(0)\r\n      })\r\n    },\r\n    // 获取阶段名称,id\r\n    getData() {\r\n      let obj1 = {\r\n        stage_id: this.stages[this.isActive].id\r\n      }\r\n      // 获取右边的表格数据\r\n      viewStagesBystage(obj1).then(res => {\r\n        this.tableData = res.data\r\n      })\r\n    },\r\n    // 编辑/更新阶段的详情\r\n    saveTable() {\r\n      let obj = {\r\n        id: this.$route.query.id,\r\n        stage_id: '1',\r\n        name: '',\r\n        type: '',\r\n        target: '',\r\n        condition: '',\r\n        attribute: ''\r\n      }\r\n      editStage(obj).then(res => {\r\n        console.log(res)\r\n      })\r\n    },\r\n    /** 鼠标移入cell */\r\n    // 鼠标双击时进入编辑模式\r\n    handleCellDblclick(row, column, cell, event) {\r\n      const property = column.property\r\n      if (this.editProp.includes(property)) {\r\n        cell.querySelector('.item__input').style.display = 'block'\r\n        cell.querySelector('.item__txt').style.display = 'none'\r\n      }\r\n    },\r\n    /** 鼠标移出cell */\r\n    handleCellLeave(row, column, cell, event) {\r\n      const property = column.property\r\n      if (this.editProp.includes(property)) {\r\n        cell.querySelector('.item__input').style.display = 'none'\r\n        cell.querySelector('.item__txt').style.display = 'block'\r\n      }\r\n      // TODO:发请求进行编辑阶段详情的保存\r\n    },\r\n    // 新增阶段详情\r\n    addStageDetail() {\r\n      this.dialogFormVisible = true\r\n    },\r\n    // 弹框1保存按钮\r\n    saveBtn() {\r\n      this.dialogFormVisible = false\r\n      let obj = {\r\n        stage_id: this.stages[this.isActive].id,\r\n        name: this.dialog.name,\r\n        type: this.dialog.type,\r\n        target: this.dialog.target,\r\n        condition: this.dialog.condition,\r\n        attribute: this.dialog.attribute,\r\n        assess_times: this.dialog.assess_times,\r\n        train_times: this.dialog.train_times\r\n      }\r\n      saveStageDetails(obj).then(res => {\r\n        console.log(res)\r\n        // this.tableData.push(res.data)\r\n        if (res.code == 200) {\r\n          this.getData()\r\n          this.$message({\r\n            message: '新增成功',\r\n            type: 'success'\r\n          })\r\n          this.getData()\r\n        }\r\n      })\r\n    },\r\n\r\n    // 进阶失败保存追加 弹框2保存按钮\r\n    saveBtn2() {\r\n      this.dialogFormVisible2 = false\r\n      let obj = {\r\n        stage_id: this.stages[this.isActive].id,\r\n        add_assess: this.dialog2.add_assess,\r\n        add_train: this.dialog2.add_train\r\n      }\r\n      saveFailureCondition(obj).then(res => {\r\n        if (res.code == 200) {\r\n          this.$message({\r\n            message: '保存成功',\r\n            type: 'success'\r\n          })\r\n        }\r\n      })\r\n    },\r\n\r\n    // 新增阶段\r\n    addStages() {\r\n      this.dialogFormVisible3 = true\r\n    },\r\n    // 新增阶段 弹框3保存按钮\r\n    saveBtn3() {\r\n      this.dialogFormVisible3 = false\r\n      let obj = {\r\n        prescription_details_id: this.$route.query.id,\r\n        stageName: this.dialog3.stageName,\r\n        totalTimes: this.dialog3.totalTimes\r\n      }\r\n      saveStage(obj).then(res => {\r\n        console.log(res)\r\n        if (res.code == 200) {\r\n          this.getLeft()\r\n          this.$message({\r\n            type: 'success',\r\n            message: '新增成功'\r\n          })\r\n        }\r\n      })\r\n    },\r\n\r\n    selectchange(val) {\r\n      this.selectdata = val\r\n    },\r\n    // 批量删除\r\n    deleteLot() {\r\n      if (this.selectdata.length) {\r\n        var list = []\r\n        this.selectdata.forEach(ele => {\r\n          list.push(ele.id)\r\n        })\r\n        deleteStageDetails({ ids: list.join(',') }).then(res => {\r\n          if (res.code == 200) {\r\n            this.getData()\r\n            this.$message({\r\n              message: '删除成功',\r\n              type: 'success'\r\n            })\r\n          }\r\n        })\r\n      }\r\n    },\r\n    // 修改阶段名称和阶段时长\r\n    editStage() {},\r\n\r\n    // 进阶失败查询/追加\r\n    failed() {\r\n      this.dialogFormVisible2 = true\r\n      let obj = {\r\n        stage_id: this.stages[this.isActive].id\r\n      }\r\n      getFailureCondition(obj).then(res => {\r\n        console.log(res.data[0])\r\n        this.dialog2 = res.data[0]\r\n      })\r\n    },\r\n    // 删除阶段\r\n    deleteStages(item) {\r\n      let obj = {\r\n        stage_id: item.id\r\n      }\r\n      deleteStage(obj).then(res => {\r\n        if (res.code == 200) {\r\n          this.getLeft()\r\n          this.$message({\r\n            type: 'success',\r\n            message: '删除成功'\r\n          })\r\n        }\r\n      })\r\n    },\r\n    next() {\r\n      this.$router.push({\r\n        path: '/avoidsymptom',\r\n        query: {\r\n          id: this.$route.query.id,\r\n          name: this.$route.query.name,\r\n          disease_position: this.$route.query.disease_position,\r\n          disease_sort: this.$route.query.disease_sort\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.item .item__input {\r\n  display: none;\r\n  width: 100px;\r\n}\r\n.item .item__txt {\r\n  box-sizing: border-box;\r\n  line-height: 24px;\r\n  padding: 0 9px;\r\n}\r\n\r\n.el-card {\r\n  height: 100%;\r\n}\r\n.head {\r\n  height: 35px;\r\n  line-height: 35px;\r\n  background: #fff;\r\n  border: 1px solid #ddd;\r\n  border-radius: 5px;\r\n  padding: 10px;\r\n  margin: 10px;\r\n}\r\n.step {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.head .step li span {\r\n  width: 30px;\r\n  height: 30px;\r\n  border-radius: 15px;\r\n  border: 1px solid orange;\r\n  padding: 3px 8px;\r\n  margin: 0 5px;\r\n}\r\n\r\n/* content的左边康复阶段区域 */\r\n.left ul,\r\nli {\r\n  list-style: none;\r\n}\r\n.left ul {\r\n  width: 100%;\r\n}\r\n.left ul li {\r\n  height: 40px;\r\n  margin-top: 20px;\r\n  line-height: 40px;\r\n  text-align: center;\r\n  font-size: 14px;\r\n  span {\r\n    width: 30px;\r\n    height: 30px;\r\n    border-radius: 15px;\r\n    border: 1px solid orange;\r\n    padding: 3px 8px;\r\n    margin: 0 5px;\r\n    background: #f49b4d;\r\n    color: #fff;\r\n  }\r\n}\r\n.active {\r\n  background-color: #ffdab9;\r\n}\r\n\r\n.right-head {\r\n  display: flex;\r\n  padding-top: 20px;\r\n  flex-wrap: wrap;\r\n  justify-content: space-around;\r\n  margin-bottom: 20px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}